{% extends "page.html" %}

{% block subtitle %}Yeni Veri Ä°steÄŸi{% endblock %}

{% block breadcrumb_content %}
  <li>{% link_for _('Ana Sayfa'), named_route='home.index' %}</li>
  <li>{% link_for _('Veri Ä°stekleri'), named_route='data_requests.index' %}</li>
  <li class="active">{% link_for _('Yeni Ä°stek'), named_route='data_requests.create' %}</li>
{% endblock %}

{% block head_extras %}
<style>
{{ super() }}
.module-content {
    padding: 1.5rem !important;
    background-color: #0072bb !important;
    border-top-left-radius: 5px !important;
    border-bottom-left-radius: 5px !important;
}

.module:first-child .module-heading {
    border-radius: 5px !important;
    border-top-width: 0 !important;
    border-bottom-width: 0 !important;
}

.module-heading {
    padding: 0.5rem 25px !important;
    font-size: 0.875rem !important;
    line-height: 1.3 !important;
    background-color: #128ede !important;
    text-align: center !important;
    color: white !important;
}
</style>
{% endblock %}

{% block secondary_content %}
<div class="module">
  <div class="module-content">
    <h2 class="module-heading">Bilgilendirme</h2>
    <div style="padding: 15px;">
      <div style="padding: 20px;border-radius: 8px;line-height: 1.6;">
        <p style="margin: 0;color: #8cbede;font-size: 15px;">
          Bu alanda Sakarya BÃ¼yÃ¼kÅŸehir Belediyesi AÃ§Ä±k Veri PortalÄ± ile alakalÄ± veri taleplerinizi iletebilirsiniz. 
          Veri isteÄŸinizin bir organizasyon ile iliÅŸkili olduÄŸunu dÃ¼ÅŸÃ¼nÃ¼yorsanÄ±z bunu belirtebilirsiniz.
        </p>
      </div>
      
      <!-- Ek Ä°puÃ§larÄ± -->
      <div style="margin-top: 20px;">
        <h4 style="color: white;margin-bottom: 10px;font-size: 16px;">ğŸ’¡ Ä°puÃ§larÄ±:</h4>
        <ul style="color: #8cbede; font-size: 13px; line-height: 1.5; margin: 0; padding-left: 20px;">
          <li>Veri isteÄŸinizi mÃ¼mkÃ¼n olduÄŸunca detaylÄ± aÃ§Ä±klayÄ±n</li>
          <li>Hangi formatta veri istediÄŸinizi belirtin (Excel, CSV, JSON vb.)</li>
          <li>Veri kullanÄ±m amacÄ±nÄ±zÄ± kÄ±saca belirtin</li>
          <li>Ä°letiÅŸim bilgilerinizin gÃ¼ncel olduÄŸundan emin olun</li>
        </ul>
      </div>
      
      <!-- Ä°letiÅŸim Bilgisi -->
      <div style="margin-top: 20px;padding: 15px;background: #128ede;border-radius: 6px;">
        <h4 style="color: white; margin: 0 0 8px 0; font-size: 14px;">ğŸ“ Ä°letiÅŸim</h4>
        <p style="margin: 0; color: white; font-size: 13px;">
          Veri istekleriniz hakkÄ±nda sorularÄ±nÄ±z iÃ§in sistem yÃ¶neticileri ile iletiÅŸime geÃ§ebilirsiniz.
        </p>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block primary_content %}
<h1>Yeni Veri Ä°steÄŸi</h1>

{% if user %}
  <div style="margin-bottom: 20px; padding: 10px; background-color: #e8f5e8; border-radius: 5px;">
    <p><strong>KullanÄ±cÄ±:</strong> {{ user.display_name or user.name }}</p>
  </div>
{% endif %}

<form method="post" style="max-width: 500px;">
  <div style="margin-bottom: 15px;">
    <label>BaÅŸlÄ±k:</label><br>
    <input type="text" name="title" value="{{ data.title if data else '' }}" style="width: 100%; padding: 5px;" required placeholder="Veri isteÄŸiniz iÃ§in kÄ±sa bir baÅŸlÄ±k yazÄ±n...">
    {% if errors and errors.title %}<div style="color: red;">{{ errors.title }}</div>{% endif %}
  </div>
  
  <div style="margin-bottom: 15px;">
    <label>Hedef Organizasyon/Birim:</label><br>
    <select name="organization_id" style="width: 100%; padding: 5px;" required>
      <option value="">Organizasyon seÃ§in...</option>
      {% for org in organizations %}
      <option value="{{ org.id }}" {% if data and data.organization_id == org.id %}selected{% endif %}>{{ org.title or org.name }}</option>
      {% endfor %}
    </select>
    {% if errors and errors.organization_id %}<div style="color: red;">{{ errors.organization_id }}</div>{% endif %}
  </div>
  
  <div style="margin-bottom: 15px;">
    <label>Veri Ä°steÄŸi AÃ§Ä±klamasÄ±:</label><br>
    <textarea name="request_text" rows="5" style="width: 100%; padding: 5px;" required placeholder="Hangi veri setine ihtiyacÄ±nÄ±z var? LÃ¼tfen detaylÄ± aÃ§Ä±klama yapÄ±n...">{{ data.request_text if data else '' }}</textarea>
    {% if errors and errors.request_text %}<div style="color: red;">{{ errors.request_text }}</div>{% endif %}
  </div>
  
  <button type="submit" style="padding: 10px 20px; background: #0066cc; color: white; border: none;">GÃ¶nder</button>
  <a href="{{ url_for('data_requests.index') }}" style="margin-left: 10px;">Ä°ptal</a>
</form>
{% endblock %}
